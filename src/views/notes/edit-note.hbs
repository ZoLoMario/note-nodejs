{{#each errors}}
<div class="alert alert-danger alert-dismissible fade show" role="alert">
  {{text}}
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{{/each}}

<div class="col-md-4 mx-auto">
  <div class="card">
    <div class="card-header">
      <h3>Edit Note</h3>
    </div>
    <div class="card-body">
      <form action="/notes/edit-note/{{note._id}}?_method=PUT" method="POST">
        <input type="hidden" name="_method" value="PUT">
        <div class="form-group">
          <input type="text" name="title" class="form-control" value="{{note.title}}"/>
        </div>

	<div class="form-group">
		<div class="ce-example">
			<div class="ce-example__content _ce-example__content--small">
				<div id="{{note._id}}"  name="description" style="padding-bottom: 0px;"></div>
			</div>
		</div>
	</div>







        <div class="form-group">
          <div id="saveEditButton" class="btn btn-primary btn-block" type="submit">
            Save
          </div>
        </div>

			<div class="ce-example__output">
				  <pre class="ce-example__output-content" id="output"></pre>
				  <div class="ce-example__output-footer">
					<a href="http://wotech.vn" style="font-weight: bold;">Made by DangKhoi</a>
				  </div>
			</div>

      </form>
    </div>
  </div>
</div>
 <script>
 	const saveButton = document.getElementById('saveEditButton');
var data = {{{note.description}}};
var blocks = data.blocks;
    var editor = new EditorJS({
		holderId:  '{{note._id}}',
		tools: tool,
		i18n: il8n,
		data: {blocks},
		onReady: function(){
			editoronReady();
			//saveButton.click();
		},
      onChange: function() {
        console.log('something changed');
      }
	});
</script>
<script>
	<!-- thêm code gửi dữ liệu khi nhấn nút -->	 
    saveButton.addEventListener('click', function () {
      editor.save().then((savedData) => {
        cPreview.show(savedData, document.getElementById("output"));
		var title = $('input[name="title"]').val();
        $.ajax({
              type : 'PUT', //Sử dụng kiểu gửi dữ liệu POST
              url : '/notes/edit-note/{{note._id}}', //gửi dữ liệu sang trang data.php
              data : {"title": title, "description":JSON.stringify(savedData)},//dữ liệu sẽ được gửi
              success : function(data)  // Hàm thực thi khi nhận dữ liệu được từ server
                        { 
                           if(data == 'false') 
                           {
                             alert('Không có người dùng');
                           }else{
                             console.log('Gửi thành công' + JSON.stringify(savedData));
							 console.log('Gửi thành công' + title);
                           }
                        }
              });
      });
    });
  </script>
